SELECT "CÓDIGOS", "NOME DAS DISCIPLINAS", "PERIODO ANO", "PERIODO SEM", "MEDIA", "CREDITOS", "SITUAÇÃO FINAL", "TOTAL DE CRÉDITOS CURSADOS", "TOTAL DE CARGA HORÁRIA CURSADA", "COEFICIENTE DE RENDIMENTO ESCOLAR"
FROM (
	SELECT 1, DISP_CODIGO AS "CÓDIGOS", DISP_NOME AS "NOME DAS DISCIPLINAS", TURM_ANO AS "PERIODO ANO", TURM_SEMESTRE AS "PERIODO SEM",
	REND_MEDIAAUX AS "MEDIA", DISP_CREDITOAUX AS "CREDITOS", REND_RESULTADO AS "SITUAÇÃO FINAL",
	(SELECT SUM (DISP_CREDITO) AS "TOTAL DE CRÉDITOS CURSADOS" FROM DISCIPLINA),
	(SELECT SUM (DISP_CARGA_HORARIA) AS "TOTAL DE CARGA HORÁRIA CURSADA" FROM DISCIPLINA),
	(SELECT SUM (REND_MEDIA_FINAL/160) AS "COEFICIENTE DE RENDIMENTO ESCOLAR" FROM RENDIMENTO)
	FROM ALUNO,RENDIMENTO,TURMA,CURSO,DISCIPLINA
	WHERE ALU_MATRICULA = REND_ALU_MATRICULA
	AND REND_TURM_CODIGO = TURM_ID
	AND TURM_DISP_CODIGO = DISP_CODIGO
	AND DISP_CUR_CODIGO = CUR_CODIGO
	AND CUR_CODIGO = ALU_CUR_CODIGO
	
	UNION
	
	SELECT 2, ALU_NOME AS "ALUNO", '', ALU_MATRICULA AS "MATRICULA", NULL, NULL, CUR_NOME AS "CURSOS", NULL, NULL, NULL, NULL
	FROM ALUNO,CURSO
	
) AS HISTORICO
ORDER BY "PERIODO ANO", "PERIODO SEM", "CÓDIGOS";


